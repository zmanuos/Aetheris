!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("highcharts"),require("highcharts").SeriesRegistry):"function"==typeof define&&define.amd?define("highcharts/modules/geoheatmap",[["highcharts/highcharts"],["highcharts/highcharts","SeriesRegistry"]],e):"object"==typeof exports?exports["highcharts/modules/geoheatmap"]=e(require("highcharts"),require("highcharts").SeriesRegistry):t.Highcharts=e(t.Highcharts,t.Highcharts.SeriesRegistry)}(this,function(t,e){return function(){"use strict";var o,i,r={512:function(t){t.exports=e},944:function(e){e.exports=t}},n={};function a(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}};return r[t](o,o.exports,a),o.exports}a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var s={};a.d(s,{default:function(){return M}});var p=a(944),h=a.n(p),l=a(512),c=a.n(l),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=c().seriesTypes.map.prototype.pointClass,f=h().isNumber,y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.applyOptions=function(e,o){var i=t.prototype.applyOptions.call(this,e,o),r=i.options,n=r.lat,a=r.lon;if(f(a)&&f(n)){var s=this.series.options,p=s.colsize,h=void 0===p?1:p,l=s.rowsize,c=void 0===l?1:l,u=a-h/2,d=n-c/2;i.geometry=i.options.geometry={type:"Polygon",coordinates:[[[u,d],[u+h,d],[u+h,d+c],[u,d+c],[u,d]]]}}return i},e}(d),g=h().doc,v=h().defined,m=h().pick,b=function(t){var e=t.canvas,o=t.context;return e&&o?(o.clearRect(0,0,e.width,e.height),o):(t.canvas=g.createElement("canvas"),t.context=t.canvas.getContext("2d",{willReadFrequently:!0})||void 0,t.context)},x=(i=function(t,e){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),w=h().animObject,D=h().stop,j=h().noop,O=function(t,e){var o=e.series.colorAxis;if(o){var i=o.toColor(t||0,e).split(")")[0].split("(")[1].split(",").map(function(t){return m(parseFloat(t),parseInt(t,10))});return i[3]=255*m(i[3],1),v(t)&&e.visible||(i[3]=0),i}return[0,0,0,0]},C=c().seriesTypes.map,_=h().addEvent,P=h().error,I=h().extend,T=h().isNumber,z=h().isObject,A=h().merge,L=h().pick;function R(t){return t-360*Math.floor((t+180)/360)}var U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDirtyCanvas=!0,e}return x(e,t),e.prototype.update=function(){this.options=A(this.options,arguments[0]),this.getInterpolation().enabled&&(this.isDirtyCanvas=!0,this.points.forEach(function(t){t.graphic&&(t.graphic.destroy(),delete t.graphic)})),t.prototype.update.apply(this,arguments)},e.prototype.translate=function(){(!this.getInterpolation().enabled||!this.image||this.isDirty||this.isDirtyData)&&t.prototype.translate.apply(this,arguments)},e.prototype.getInterpolation=function(){return z(this.options.interpolation)?this.options.interpolation:{blur:1,enabled:this.options.interpolation}},e.prototype.drawPoints=function(){var e=this.chart.mapView,o=this.options;if(this.getInterpolation().enabled&&e&&this.bounds){var i=this.context||b(this),r=this.canvas,n=this.colorAxis,a=this.image,s=this.chart,p=this.points,h=[L(o.colsize,1),L(o.rowsize,1)],l=h[0],c=h[1],u=e.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),d=e.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(r&&i&&n&&u&&d){var f=u.x,y=u.y,g=d.x-f,v=d.y-y,m={x:f,y:y,width:g,height:v};if(this.isDirtyCanvas||this.isDirtyData||"Orthographic"===e.projection.options.name){var x=r.width=~~(360/l)+1,j=r.height=~~(180/c)+1,C=new Uint8ClampedArray(x*j*4),_=p[0].options,I=_.lat,z=_.lon,R=(void 0===z?0:z)%c!=0,U=(void 0===I?0:I)%l!=0,M=R?function(t){return Math.round(t/c)*c}:function(t){return t},S=U?function(t){return Math.round(t/l)*l}:function(t){return t},k=p.length;(R||U)&&P("Highcharts Warning: For best performance, lon/lat datapoints should spaced by a single colsize/rowsize",!1,this.chart,{colsize:String(l),rowsize:String(c)}),this.directTouch=!1,this.isDirtyCanvas=!0;for(var N=0;N<k;N++){var q,E=p[N],F=E.options,H=F.lon,X=F.lat;T(H)&&T(X)&&C.set(O(E.value,E),4*(q=M(H),Math.ceil(x*(j-1-(S(X)+90)/c)+(q+180)/l)))}var V=this.getInterpolation().blur,W=0===V?1:11*V,Y=~~(x*W),J=~~(j*W),K=~~g,B=~~v,G=new ImageData(C,x,j);r.width=Y,r.height=J,i.putImageData(G,0,0),i.globalCompositeOperation="copy",i.drawImage(r,0,0,G.width,G.height,0,0,Y,J);var Q=this.getProjectedImageData(e,K,B,i.getImageData(0,0,Y,J),r,f,y);r.width=K,r.height=B,i.putImageData(new ImageData(Q,K,B),0,0)}if(a){if(s.renderer.globalAnimation&&s.hasRendered){var Z=Number(a.attr("x")),$=Number(a.attr("y")),tt=Number(a.attr("width")),te=Number(a.attr("height")),to=function(t,e){var o=e.pos;a.attr({x:Z+(f-Z)*o,y:$+(y-$)*o,width:tt+(g-tt)*o,height:te+(v-te)*o})},ti=A(w(s.renderer.globalAnimation)),tr=ti.step;ti.step=function(){tr&&tr.apply(this,arguments),to.apply(this,arguments)},a.attr(A({animator:0},this.isDirtyCanvas?{href:r.toDataURL("image/png",1)}:void 0)).animate({animator:1},ti)}else D(a),a.attr(A(m,this.isDirtyCanvas?{href:r.toDataURL("image/png",1)}:void 0))}else this.image=s.renderer.image(r.toDataURL("image/png",1)).attr(m).add(this.group);this.isDirtyCanvas=!1}}else t.prototype.drawPoints.apply(this,arguments)},e.prototype.getProjectedImageData=function(t,e,o,i,r,n,a){for(var s,p=new Uint8ClampedArray(e*o*4),h=L(null===(s=t.projection.options.rotation)||void 0===s?void 0:s[0],0),l=r.width/360,c=-1*r.height/180,u=-1,d=0;d<p.length;d+=4){var f=d/4%e;0===f&&u++;var y=t.pixelsToLonLat({x:n+f,y:a+u});if(y){y.lon>-180-h&&y.lon<180-h&&(y.lon=R(y.lon));var g=[y.lon,y.lat],v=g[0]*l+r.width/2,m=g[1]*c+r.height/2;if(v>=0&&v<=r.width&&m>=0&&m<=r.height){var b=Math.floor(m)*r.width*4+4*Math.round(v);p[d]=i.data[b],p[d+1]=i.data[b+1],p[d+2]=i.data[b+2],p[d+3]=i.data[b+3]}}}return p},e.prototype.searchPoint=function(t,e){var o=this.chart,i=o.mapView;if(i&&this.bounds&&this.image&&o.tooltip&&o.tooltip.options.enabled){if(!o.pointer.hasDragged&&(.01>=+this.image.attr("animator")||+this.image.attr("animator")>=.99)){var r=i.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),n=i.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(o.pointer.normalize(t),t.lon&&t.lat&&r&&n&&t.chartX-o.plotLeft>r.x&&t.chartX-o.plotLeft<n.x&&t.chartY-o.plotTop>r.y&&t.chartY-o.plotTop<n.y)return this.searchKDTree({clientX:t.chartX,lon:R(t.lon),lat:t.lat},e,t)}else o.tooltip.destroy()}},e.defaultOptions=A(C.defaultOptions,{nullColor:"transparent",tooltip:{pointFormat:"Lat: {point.lat}, Lon: {point.lon}, Value: {point.value}<br/>"},borderWidth:0,colsize:1,rowsize:1,stickyTracking:!0,interpolation:{enabled:!1,blur:1}}),e}(C);_(U,"afterDataClassLegendClick",function(){this.isDirtyCanvas=!0,this.drawPoints()}),I(U.prototype,{type:"geoheatmap",applyJitter:j,pointClass:y,pointArrayMap:["lon","lat","value"],kdAxisArray:["lon","lat"]}),c().registerSeriesType("geoheatmap",U);var M=h();return s.default}()});